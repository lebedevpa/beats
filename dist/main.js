"use strict";var openItem=function(e){var t=e.closest(".slider__item"),o=t.find(".slider__description"),e=o.find(".slider__description--wrap").height();t.addClass("slider__item--active"),o.height(e)},closeEveryItem=function(e){var t=e.find(".slider__description");e.find(".slider__item").removeClass("slider__item--active"),t.height(0)};$(".slider__name").click(function(e){var t=$(e.currentTarget),e=t.closest(".slider__list");t.closest(".slider__item").hasClass("slider__item--active")?closeEveryItem(e):(closeEveryItem(e),openItem(t))});var button=document.querySelector("#toggle"),menu=document.querySelector("#burger-menu"),hamburger=document.querySelector("#hamburger"),body=document.querySelector("body"),toggleMenu=function(){button.classList.toggle("hamburger-container--active"),hamburger.classList.toggle("hamburger--active"),menu.classList.toggle("burger-menu--open"),body.classList.toggle("body-active-menu")};button.addEventListener("click",toggleMenu);var sections=$("section"),display=$(".main-content"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1;sections.first().addClass("section--active");var myMap,performTransition=function(e){var t,o,r;!1===inScroll&&(inScroll=!0,t=-100*e,o=sections.eq(e).attr("data-sidemenu-theme"),r=$(".fixed-menu"),"white"===o?r.addClass("fixed-menu__link--theme--light"):r.removeClass("fixed-menu__link--theme--light"),display.css({transform:"translateY(".concat(t,"%)")}),sections.eq(e).addClass("section--active").siblings().removeClass("section--active"),setTimeout(function(){inScroll=!1,r.find(".fixed-menu__item").eq(e).addClass("fixed-menu__item--active").siblings().removeClass("fixed-menu__item--active")},1300))},scrollViewport=function(e){var t=sections.filter(".section--active"),o=t.next(),t=t.prev();"next"===e&&o.length&&performTransition(o.index()),"prev"===e&&t.length&&performTransition(t.index())};$(window).on("wheel",function(e){e=e.originalEvent.deltaY;0<e&&scrollViewport("next"),e<0&&scrollViewport("prev")}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase();if("input"!=t&&"textarea"!=t)switch(e.keyCode){case 38:scrollViewport("prev");break;case 40:scrollViewport("next")}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){viewportScroller()["down"===t?"prev":"up"===t?"next":""]()}});var init=function(){myMap=new ymaps.Map("map",{center:[34.687007,33.036272],zoom:11,controls:[]});for(var e=[[34.67074,33.039237],[34.681929,33.051514],[34.693166,33.082867],[34.703852,33.048932]],t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"img/svg/marker.svg",iconImageSize:[46,57],iconImageOffset:[-35,-52]}),o=0;o<e.length;o++)t.add(new ymaps.Placemark(e[o]));myMap.geoObjects.add(t),myMap.behaviors.enable("scrollZoom")};ymaps.ready(init);var list=$(".products-menu__list");list.on("click",".product",function(e){e.preventDefault(),$(this).siblings("li").removeClass("product--active"),$(this).toggleClass("product--active");var t=$(this).find(".product__content"),o=0,e=524;$(window).width()<=768&&480<$(window).width()&&(o=$(".product__title").width()*$(".product__title").length,e=$(window).width()-o),$(window).width()<480&&(o=$(".product__title").width(),e=$(window).width()-o),list.find(".product__content").css("width",0),$(this).hasClass("product--active")&&t.css("width","".concat(e,"px"))});var currentVolume,playerContainer=document.querySelector(".player"),video=document.querySelector(".video"),playerStart=document.querySelector(".player__start"),playerPlayback=document.querySelector(".player__playback"),progressBar=document.querySelector(".player__playback-line"),playerVideoCircle=document.querySelector(".player__playback-button"),playerVolumeIcon=document.querySelector(".player__volume-icon"),playerVolumeBar=document.querySelector(".player__volume"),playerVolumeCircle=document.querySelector(".player__volume-button"),startVolume=0,handleStart=function(){video.paused?(video.play(),playerStart.classList.add("player__start--active")):(video.pause(),playerStart.classList.remove("player__start--active"))};playerStart.addEventListener("click",handleStart),video.addEventListener("click",handleStart),video.onplay=function(){togglePlayer()},video.onpause=function(){togglePlayer("pause")};var togglePlayer=function(){"start"===(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"start")?playerContainer.classList.add("player--active"):playerContainer.classList.remove("player--active")},changeCirclePosition=function(e){},changeVolume=function(e){var t=e.currentTarget,e=e.offsetX,t=parseInt(getComputedStyle(t).width);console.log(e),console.log(t),console.log("soundBarwidth - left",t-e);t=e/t*100;t<100&&(video.volume=t/100,playerVolumeCircle.style.left="".concat(t,"%"),changeCirclePosition(t),document.querySelector(".player__volume-bar").style.width="".concat(t,"%"))},toggleSound=function(){playerVolumeIcon.classList.toggle("muted"),0===video.volume?(video.volume=currentVolume,playerVolumeCircle.style.left="".concat(100*currentVolume,"%"),changeCirclePosition(NaN)):(currentVolume=video.volume,video.volume=startVolume,playerVolumeCircle.style.left="".concat(startVolume,"%"),changeCirclePosition("startVolume"))};playerVolumeBar.addEventListener("click",changeVolume),playerVolumeIcon.addEventListener("click",toggleSound);var interval,handleDuration=function(e){var t=parseInt(getComputedStyle(playerPlayback).width),e=(parseInt(getComputedStyle(playerVideoCircle).width),e.offsetX/t*100),t=(video.duration,video.duration/100);video.currentTime=e*t,progressBar.style.width="".concat(e,"%")},updateTime=function(){video.paused?clearInterval(interval):interval=setInterval(function(){var e=video.currentTime,t=video.duration;progressBar.style.width="".concat(e/t*100,"%")},1e3),progressBar.style.width="".concat(currentTime,"%")};playerPlayback.addEventListener("click",handleDuration),video.addEventListener("click",updateTime);var findBlockByAlias=function(o){return $(".review__item").filter(function(e,t){return $(t).attr("data-linked-with")==o})};$(".avatar-round").click(function(e){e.preventDefault();var t=$(e.currentTarget),e=t.attr("data-open"),t=t.closest(".usernames__item");findBlockByAlias(e).addClass("review__item--active").siblings().removeClass("review__item--active"),t.addClass("username--active").siblings().removeClass("username--active")});var slider=$(".shop__list").bxSlider({pager:!1,controls:!1});$(".shop__btn_left").click(function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".shop__btn_right").click(function(e){e.preventDefault(),slider.goToNextSlide()});var validateFields=function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length};$(".form").submit(function(e){e.preventDefault();var t=$(e.currentTarget),o=t.find("[name='name']"),r=t.find("[name='phone']"),i=t.find("[name='comment']"),e=t.find("[name='to']"),a=$("#modal"),n=a.find(".modal__content");a.removeClass("error-modal"),validateFields(t,[o,r,i,e])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:o.val(),phone:r.val(),comment:i.val(),to:e.val()}})).done(function(e){n.text(e.message)}),e.fail(function(e){e=e.responseJSON.message;n.text(e),a.addClass("error-modal")}),e.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".app-submit-btn").click(function(e){e.preventDefault(),$.fancybox.close()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGVvbi5qcyIsIm1haW4uanMiLCJtYXAuanMiLCJtZW51QWNjb3JkZW9uLmpzIiwicGxheWVyLmpzIiwicmV2aWV3c1NsaWRlci5qcyIsInNob3BTbGlkZXIuanMiLCJ2YWxpZGF0ZUZvcm0uanMiXSwibmFtZXMiOlsib3Blbkl0ZW0iLCJpdGVtIiwiY29udGFpbmVyIiwiY2xvc2VzdCIsImNvbnRlbnRCbG9jayIsImZpbmQiLCJyZXFIZWlnaHQiLCJoZWlnaHQiLCJhZGRDbGFzcyIsImNsb3NlRXZlcnlJdGVtIiwiaXRlbXMiLCJyZW1vdmVDbGFzcyIsIiQiLCJjbGljayIsImUiLCIkdGhpcyIsImN1cnJlbnRUYXJnZXQiLCJoYXNDbGFzcyIsImJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1lbnUiLCJoYW1idXJnZXIiLCJib2R5IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiaXRlbUNvbnRhaW5lciIsImRpc3BsYXkiLCJtb2JpbGVEZXRlY3QiLCJNb2JpbGVEZXRlY3QiLCJ3aW5kb3ciLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJpc01vYmlsZSIsIm1vYmlsZSIsImluU2Nyb2xsIiwic2VjdGlvbnMiLCJmaXJzdCIsIm15TWFwIiwicG9zaXRpb24iLCJtZW51VGhlbWUiLCJzaWRlTWVudSIsInNlY3Rpb25FcSIsImVxIiwiYXR0ciIsImNzcyIsInRyYW5zZm9ybSIsImNvbmNhdCIsInNpYmxpbmdzIiwic2V0VGltZW91dCIsImFjdGl2ZVNlY3Rpb24iLCJmaWx0ZXIiLCJkaXJlY3Rpb24iLCJwcmV2U2VjdGlvbiIsImxlbmd0aCIsInBlcmZvcm1UcmFuc2l0aW9uIiwiaW5kZXgiLCJvbiIsImRlbHRhWSIsIm9yaWdpbmFsRXZlbnQiLCJzY3JvbGxWaWV3cG9ydCIsInRhZ05hbWUiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJldmVudCIsInZpZXdwb3J0U2Nyb2xsZXIiLCJpbml0IiwieW1hcHMiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiY29udHJvbHMiLCJjb29yZHMiLCJteUNvbGxlY3Rpb24iLCJHZW9PYmplY3RDb2xsZWN0aW9uIiwiZHJhZ2dhYmxlIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaWNvbkltYWdlT2Zmc2V0IiwiaSIsImFkZCIsIlBsYWNlbWFyayIsImdlb09iamVjdHMiLCJiZWhhdmlvcnMiLCJlbmFibGUiLCJyZWFkeSIsImxpc3QiLCJ0aGlzIiwidG9nZ2xlQ2xhc3MiLCIkY29udGVudCIsImN1cldpZHRoIiwibmV3V2lkdGgiLCJ3aWR0aCIsImN1cnJlbnRWb2x1bWUiLCJwbGF5ZXJDb250YWluZXIiLCJ2aWRlbyIsInBsYXllclN0YXJ0IiwicGxheWVyUGxheWJhY2siLCJwcm9ncmVzc0JhciIsInBsYXllclZpZGVvQ2lyY2xlIiwicGxheWVyVm9sdW1lSWNvbiIsInBsYXllclZvbHVtZUJhciIsInBsYXllclZvbHVtZUNpcmNsZSIsInN0YXJ0Vm9sdW1lIiwiaGFuZGxlU3RhcnQiLCJwYXVzZWQiLCJwbGF5IiwicGF1c2UiLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwib25wbGF5IiwidG9nZ2xlUGxheWVyIiwib25wYXVzZSIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsImNoYW5nZUNpcmNsZVBvc2l0aW9uIiwicGVyY2VudCIsImNoYW5nZVZvbHVtZSIsImxlZnQiLCJvZmZzZXRYIiwic291bmRCYXJXaWR0aCIsInBhcnNlSW50IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImNvbnNvbGUiLCJsb2ciLCJwZXJjZW50VmFsdWUiLCJ2b2x1bWUiLCJzdHlsZSIsInRvZ2dsZVNvdW5kIiwiaW50ZXJ2YWwiLCJoYW5kbGVEdXJhdGlvbiIsImJhclNpemUiLCJkdXJhdGlvbk9uZSIsImR1cmF0aW9uIiwiY3VycmVudFRpbWUiLCJ1cGRhdGVUaW1lIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiY29tcGxldGVkVGltZSIsInZpZGVvRHVyYXRpb24iLCJmaW5kQmxvY2tCeUFsaWFzIiwiYWxpYXMiLCJuZHgiLCJjdXJJdGVtIiwic2xpZGVyIiwiYnhTbGlkZXIiLCJwYWdlciIsImdvVG9QcmV2U2xpZGUiLCJnb1RvTmV4dFNsaWRlIiwidmFsaWRhdGVGaWVsZHMiLCJmb3JtIiwiZmllbGRzQXJyYXkiLCJmb3JFYWNoIiwiZmllbGQiLCJ2YWwiLCJ0cmltIiwic3VibWl0IiwibmFtZSIsInBob25lIiwiY29tbWVudCIsInRvIiwibW9kYWwiLCJjb250ZW50IiwicmVxdWVzdCIsImFqYXgiLCJ1cmwiLCJtZXRob2QiLCJkYXRhIiwiZG9uZSIsInRleHQiLCJtZXNzYWdlIiwiZmFpbCIsInJlc3BvbnNlSlNPTiIsImFsd2F5cyIsImZhbmN5Ym94Iiwib3BlbiIsInNyYyIsInR5cGUiLCJjbG9zZSJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBQUEsU0FBQSxTQUFBQyxHQUNBLElBQUFDLEVBQUFELEVBQUFFLFFBQUEsaUJBQ0FDLEVBQUFGLEVBQUFHLEtBQUEsd0JBRUFDLEVBREFGLEVBQUFDLEtBQUEsOEJBQ0FFLFNBR0FMLEVBQUFNLFNBQUEsd0JBQ0FKLEVBQUFHLE9BQUFELElBR0FHLGVBQUEsU0FBQVAsR0FFQSxJQUFBUSxFQUFBUixFQUFBRyxLQUFBLHdCQUNBSCxFQUFBRyxLQUFBLGlCQUVBTSxZQUFBLHdCQUNBRCxFQUFBSCxPQUFBLElBSUFLLEVBQUEsaUJBQUFDLE1BQUEsU0FBQUMsR0FDQSxJQUFBQyxFQUFBSCxFQUFBRSxFQUFBRSxlQUNBZCxFQUFBYSxFQUFBWixRQUFBLGlCQUNBWSxFQUFBWixRQUFBLGlCQUdBYyxTQUFBLHdCQUNBUixlQUFBUCxJQUVBTyxlQUFBUCxHQUNBRixTQUFBZSxNQS9CQSxJQUFBRyxPQUFBQyxTQUFBQyxjQUFBLFdBQ0FDLEtBQUFGLFNBQUFDLGNBQUEsZ0JBQ0FFLFVBQUFILFNBQUFDLGNBQUEsY0FDQUcsS0FBQUosU0FBQUMsY0FBQSxRQUlBbEIsV0FB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LEVBQUFzSyxTQUFBSSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgb3Blbkl0ZW0gPSBpdGVtID0+IHtcbiAgICBjb25zdCBjb250YWluZXIgPSBpdGVtLmNsb3Nlc3QoXCIuc2xpZGVyX19pdGVtXCIpO1xuICAgIGNvbnN0IGNvbnRlbnRCbG9jayA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9fZGVzY3JpcHRpb25cIik7XG4gICAgY29uc3QgdGV4dEJsb2NrID0gY29udGVudEJsb2NrLmZpbmQoXCIuc2xpZGVyX19kZXNjcmlwdGlvbi0td3JhcFwiKTtcbiAgICBjb25zdCByZXFIZWlnaHQgPSB0ZXh0QmxvY2suaGVpZ2h0KCk7XG5cblxuICAgIGNvbnRhaW5lci5hZGRDbGFzcyhcInNsaWRlcl9faXRlbS0tYWN0aXZlXCIpXG4gICAgY29udGVudEJsb2NrLmhlaWdodChyZXFIZWlnaHQpO1xufSAgIFxuXG5jb25zdCBjbG9zZUV2ZXJ5SXRlbSA9IGNvbnRhaW5lciA9PiB7XG5cbiAgICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9fZGVzY3JpcHRpb25cIik7XG4gICAgY29uc3QgaXRlbUNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9faXRlbVwiKTtcblxuICAgIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJzbGlkZXJfX2l0ZW0tLWFjdGl2ZVwiKTtcbiAgICBpdGVtcy5oZWlnaHQoMCk7XG5cbn1cblxuJCgnLnNsaWRlcl9fbmFtZScpLmNsaWNrKChlKSA9PiB7XG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgY29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi5zbGlkZXJfX2xpc3RcIik7XG4gICAgY29uc3QgZWxlbUNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIuc2xpZGVyX19pdGVtXCIpO1xuXG5cbiAgICBpZiAoZWxlbUNvbnRhaW5lci5oYXNDbGFzcyhcInNsaWRlcl9faXRlbS0tYWN0aXZlXCIpKSB7XG4gICAgICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTsgXG4gICAgICAgIG9wZW5JdGVtKCR0aGlzKTtcbiAgICB9XG5cbn0pIiwiLy8gaGFtYnVyZ2VyLW1lbnUgdG9nZ2xlIG9uL29mZlxuXG5sZXQgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RvZ2dsZScpO1xubGV0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYnVyZ2VyLW1lbnUnKTsgIFxubGV0IGhhbWJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNoYW1idXJnZXInKVxubGV0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG5cbmxldCB0b2dnbGVNZW51ID0gZnVuY3Rpb24oKSB7XG4gICAgYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2hhbWJ1cmdlci1jb250YWluZXItLWFjdGl2ZScpO1xuICAgIGhhbWJ1cmdlci5jbGFzc0xpc3QudG9nZ2xlKCdoYW1idXJnZXItLWFjdGl2ZScpXG4gICAgbWVudS5jbGFzc0xpc3QudG9nZ2xlKCdidXJnZXItbWVudS0tb3BlbicpO1xuICAgIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnYm9keS1hY3RpdmUtbWVudScpO1xufVxuXG5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVNZW51KTsgICBcblxuLy8gT1BTXG5cbmNvbnN0IHNlY3Rpb25zID0gJChcInNlY3Rpb25cIik7XG5jb25zdCBkaXNwbGF5ID0gJChcIi5tYWluLWNvbnRlbnRcIilcbmNvbnN0IG1vYmlsZURldGVjdCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xuY29uc3QgaXNNb2JpbGUgPSBtb2JpbGVEZXRlY3QubW9iaWxlKCk7XG5cbmxldCBpblNjcm9sbCA9IGZhbHNlO1xuXG5zZWN0aW9ucy5maXJzdCgpLmFkZENsYXNzKFwic2VjdGlvbi0tYWN0aXZlXCIpO1xuXG5jb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XG5cbiAgICBpZiAoaW5TY3JvbGwgPT09IGZhbHNlKSB7XG4gICAgICAgIGluU2Nyb2xsID0gdHJ1ZTtcbiAgICAgICAgY29uc3QgcG9zaXRpb24gPSBzZWN0aW9uRXEgKiAtMTAwO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRTZWN0aW9uID0gc2VjdGlvbnMuZXEoc2VjdGlvbkVxKTtcbiAgICAgICAgY29uc3QgbWVudVRoZW1lID0gY3VycmVudFNlY3Rpb24uYXR0cihcImRhdGEtc2lkZW1lbnUtdGhlbWVcIik7XG4gICAgICAgIGNvbnN0IHNpZGVNZW51ID0gJChcIi5maXhlZC1tZW51XCIpO1xuXG5cbiAgICAgICAgaWYgKG1lbnVUaGVtZSA9PT0gXCJ3aGl0ZVwiKSB7XG4gICAgICAgICAgICBzaWRlTWVudS5hZGRDbGFzcyhcImZpeGVkLW1lbnVfX2xpbmstLXRoZW1lLS1saWdodFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNpZGVNZW51LnJlbW92ZUNsYXNzKFwiZml4ZWQtbWVudV9fbGluay0tdGhlbWUtLWxpZ2h0XCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZGlzcGxheS5jc3Moe1xuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYFxuICAgICAgICB9KVxuICAgIFxuICAgICAgICBzZWN0aW9ucy5lcShzZWN0aW9uRXEpLmFkZENsYXNzKFwic2VjdGlvbi0tYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJzZWN0aW9uLS1hY3RpdmVcIik7XG4gICAgICAgIFxuICAgICAgICBcblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGluU2Nyb2xsID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKS5lcShzZWN0aW9uRXEpLmFkZENsYXNzKFwiZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XG5cbiAgICAgICAgfSwgMTMwMCk7XG4gICAgfVxuXG4gICBcbn07XG5cbmNvbnN0IHNjcm9sbFZpZXdwb3J0ID0gZGlyZWN0aW9uID0+IHtcblxuICAgIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuc2VjdGlvbi0tYWN0aXZlXCIpO1xuICAgIGNvbnN0IG5leHRTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5uZXh0KCk7XG4gICAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcblxuICAgIGlmIChkaXJlY3Rpb24gPT09IFwibmV4dFwiICYmIG5leHRTZWN0aW9uLmxlbmd0aCkge1xuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcbiAgICB9XG5cbiAgICBpZiAoZGlyZWN0aW9uID09PSBcInByZXZcIiAmJiBwcmV2U2VjdGlvbi5sZW5ndGgpIHtcbiAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24ocHJldlNlY3Rpb24uaW5kZXgoKSk7XG4gICAgfVxufTtcblxuXG4kKHdpbmRvdykub24oXCJ3aGVlbFwiLCBlID0+IHtcbiAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xuXG4gICAgaWYgKGRlbHRhWSA+IDApIHtcbiAgICAgICAgc2Nyb2xsVmlld3BvcnQoXCJuZXh0XCIpO1xuXG4gICAgfVxuXG4gICAgaWYgKGRlbHRhWSA8IDApIHtcbiAgICAgICAgc2Nyb2xsVmlld3BvcnQoXCJwcmV2XCIpO1xuXG4gICAgfVxuXG59KTtcblxuwqAkKHdpbmRvdykub24oXCJrZXlkb3duXCIsIChlKSA9PiB7XG4gICAgY29uc3QgdGFnTmFtZSA9IGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgIGlmICh0YWdOYW1lICE9IFwiaW5wdXRcIiAmJiB0YWdOYW1lICE9IFwidGV4dGFyZWFcIikge1xuICAgICAgICBzd2l0Y2ggKGUua2V5Q29kZSl7XG4gICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgIHNjcm9sbFZpZXdwb3J0KFwicHJldlwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICBcbiAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgICAgc2Nyb2xsVmlld3BvcnQoXCJuZXh0XCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn0pO1xuXG4kKFwiLndyYXBwZXJcIikub24oXCJ0b3VjaG1vdmVcIiwgZSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xuXG4kKFwiW2RhdGEtc2Nyb2xsLXRvXVwiKS5jbGljayhlID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1zY3JvbGwtdG9cIik7XG4gICAgY29uc3QgcmVxU2VjdGlvbiA9ICQoYFtkYXRhLXNlY3Rpb24taWQ9JHt0YXJnZXR9XWApO1xuXG4gICAgcGVyZm9ybVRyYW5zaXRpb24ocmVxU2VjdGlvbi5pbmRleCgpKTtcblxufSk7XG5cbmlmIChpc01vYmlsZSkge1xuICAgICQoXCJib2R5XCIpLnN3aXBlKHtcbiAgICAgICAgc3dpcGU6IGZ1bmN0aW9uIChldmVudCwgZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcbiAgICAgICAgICAgIGxldCBzY3JvbGxEaXJlY3Rpb24gPSBcIlwiO1xuICAgIFxuICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJ1cFwiKXNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xuICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJkb3duXCIpc2Nyb2xsRGlyZWN0aW9uID0gXCJwcmV2XCI7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHNjcm9sbGVyW3Njcm9sbERpcmVjdGlvbl0oKTtcbiAgICAgICAgfSxcbiAgICB9KTtcbn1cblxuLy8gaHR0cHM6Ly9naXRodWIuY29tL21hdHRicnlzb24vVG91Y2hTd2lwZS1KcXVlcnktUGx1Z2luXG5cblxuICAgICIsImxldCBteU1hcDtcbmNvbnN0IGluaXQgPSAoKSA9PiB7XG4gbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcbiAgICBjZW50ZXI6IFszNC42ODcwMDcsIDMzLjAzNjI3Ml0sXG4gICAgem9vbTogMTEsXG4gICAgY29udHJvbHM6IFtdLFxuICB9KTtcbiAgXG4gIGxldCBjb29yZHMgPSBbXG4gICAgICBbMzQuNjcwNzQwLCAzMy4wMzkyMzddLFxuICAgICAgWzM0LjY4MTkyOSwgMzMuMDUxNTE0XSxcbiAgICAgIFszNC42OTMxNjYsIDMzLjA4Mjg2N10sXG4gICAgICBbMzQuNzAzODUyLCAzMy4wNDg5MzJdLFxuICAgIF0sXG4gICAgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oe30sIHtcbiAgICAgIGRyYWdnYWJsZTogZmFsc2UsXG4gICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXG4gICAgICBpY29uSW1hZ2VIcmVmOiAnaW1nL3N2Zy9tYXJrZXIuc3ZnJyxcbiAgICAgIGljb25JbWFnZVNpemU6IFs0NiwgNTddLFxuICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTM1LCAtNTJdXG4gICB9KTtcbiBcbiBmb3IgKGxldCBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgbXlDb2xsZWN0aW9uLmFkZChuZXcgeW1hcHMuUGxhY2VtYXJrKGNvb3Jkc1tpXSkpO1xuIH1cbiBcbiBteU1hcC5nZW9PYmplY3RzLmFkZChteUNvbGxlY3Rpb24pO1xuIFxuIG15TWFwLmJlaGF2aW9ycy5lbmFibGUoJ3Njcm9sbFpvb20nKTtcbn07XG4gXG55bWFwcy5yZWFkeShpbml0KTsiLCIvLyBjb25zdCBtZWFzdXJlV2lkdGggPSAoKSA9PiB7XG4vLyAgICAgcmV0dXJuIDUyNDtcbi8vIH1cblxuLy8gY29uc3Qgb3BlblByb2R1Y3QgPSBpdGVtID0+IHtcbi8vICAgICBjb25zdCBoaWRkZW5Db250ZW50ID0gaXRlbS5maW5kKCcucHJvZHVjdF9fY29udGVudCcpO1xuLy8gICAgIGNvbnN0IHJlcVdpZHRoID0gbWVhc3VyZVdpZHRoKCk7XG4gICAgXG4vLyAgICAgaGlkZGVuQ29udGVudC53aWR0aChyZXFXaWR0aCk7XG4vLyB9XG5cbi8vICQoXCIucHJvZHVjdFwiKS5vbignY2xpY2snLCBlID0+IHtcbi8vICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4vLyAgICAgY29uc29sZS5sb2coKTtcbi8vICAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbi8vICAgICBjb25zdCBpdGVtID0gJHRoaXMuY2xvc2VzdChcIi5wcm9kdWN0XCIpXG5cbi8vICAgICBvcGVuUHJvZHVjdChpdGVtKTtcbi8vIH0pXG5cblxuXG5jb25zdCBsaXN0ID0gJCgnLnByb2R1Y3RzLW1lbnVfX2xpc3QnKTtcblxubGlzdC5vbignY2xpY2snLCAnLnByb2R1Y3QnLCBmdW5jdGlvbiAoZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAkKHRoaXMpLnNpYmxpbmdzKCdsaScpLnJlbW92ZUNsYXNzKCdwcm9kdWN0LS1hY3RpdmUnKTtcbiAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdwcm9kdWN0LS1hY3RpdmUnKTtcbiAgICBsZXQgJGNvbnRlbnQgPSAkKHRoaXMpLmZpbmQoJy5wcm9kdWN0X19jb250ZW50Jyk7XG5cbiAgICBsZXQgY3VyV2lkdGggPSAwO1xuICAgIGxldCBuZXdXaWR0aCA9IDUyNDtcblxuICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8PSA3NjggJiYgJCh3aW5kb3cpLndpZHRoKCkgPiA0ODApIHtcbiAgICAgICAgY3VyV2lkdGggPSAkKCcucHJvZHVjdF9fdGl0bGUnKS53aWR0aCgpICogJCgnLnByb2R1Y3RfX3RpdGxlJykubGVuZ3RoO1xuICAgICAgICBuZXdXaWR0aCA9ICQod2luZG93KS53aWR0aCgpIC0gY3VyV2lkdGg7XG5cbiAgICB9XG4gICAgXG4gICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNDgwKSB7XG4gICAgICAgIGN1cldpZHRoID0gJCgnLnByb2R1Y3RfX3RpdGxlJykud2lkdGgoKTtcbiAgICAgICAgbmV3V2lkdGggPSAkKHdpbmRvdykud2lkdGgoKSAtIGN1cldpZHRoO1xuXG4gICAgfVxuXG5cbiAgICBsaXN0LmZpbmQoJy5wcm9kdWN0X19jb250ZW50JykuY3NzKCd3aWR0aCcsIDApO1xuXG4gICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ3Byb2R1Y3QtLWFjdGl2ZScpKSB7XG4gICAgICAgICRjb250ZW50LmNzcygnd2lkdGgnLCBgJHtuZXdXaWR0aH1weGApO1xuICAgIH1cblxuXG4gICAgLy8gaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdwcm9kdWN0LS1hY3RpdmUnKSkge1xuICAgIC8vICAgICAkY29udGVudC5jc3MoJ3dpZHRoJywgMCk7XG4gICAgLy8gfVxuXG5cbn0pIiwiY29uc3QgcGxheWVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcicpO1xuY29uc3QgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW8nKTtcbmNvbnN0IHBsYXllclN0YXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fc3RhcnQnKTtcbmNvbnN0IHBsYXllclBsYXliYWNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcGxheWJhY2snKTtcbmNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcGxheWJhY2stbGluZScpO1xuY29uc3QgcGxheWVyVmlkZW9DaXJjbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wbGF5YmFjay1idXR0b24nKTtcbmNvbnN0IHBsYXllclZvbHVtZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX192b2x1bWUtaWNvbicpO1xuY29uc3QgcGxheWVyVm9sdW1lQmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fdm9sdW1lJyk7XG5jb25zdCBwbGF5ZXJWb2x1bWVDaXJjbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX192b2x1bWUtYnV0dG9uJyk7XG5cbmxldCBzdGFydFZvbHVtZSA9IDA7XG5sZXQgY3VycmVudFZvbHVtZTtcblxuXG4vLyDQt9Cw0L/Rg9GB0Log0YTRg9C90LrRhtC40L7QvdCw0LvQsFxuXG5jb25zdCBoYW5kbGVTdGFydCA9ICgpID0+IHtcblxuICBpZih2aWRlby5wYXVzZWQpe1xuICAgIHZpZGVvLnBsYXkoKTtcbiAgICBwbGF5ZXJTdGFydC5jbGFzc0xpc3QuYWRkKCdwbGF5ZXJfX3N0YXJ0LS1hY3RpdmUnKTtcbiAgfSBlbHNlIHtcbiAgICB2aWRlby5wYXVzZSgpO1xuICAgIHBsYXllclN0YXJ0LmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXllcl9fc3RhcnQtLWFjdGl2ZScpO1xuICB9XG5cbn1cblxucGxheWVyU3RhcnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVTdGFydCk7XG52aWRlby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVN0YXJ0KTtcblxuXG4vLyDQt9C90LDRh9C+0LogcGxheSBcblxudmlkZW8ub25wbGF5ID0gKCkgPT4ge1xuICB0b2dnbGVQbGF5ZXIoKTtcbn1cblxudmlkZW8ub25wYXVzZSA9ICgpID0+IHtcbiAgdG9nZ2xlUGxheWVyKFwicGF1c2VcIik7XG59IFxuXG5jb25zdCB0b2dnbGVQbGF5ZXIgPSAoYWN0aW9uID0gXCJzdGFydFwiICkgPT4ge1xuICBpZiAoYWN0aW9uID09PSBcInN0YXJ0XCIpIHtcbiAgICBwbGF5ZXJDb250YWluZXIuY2xhc3NMaXN0LmFkZCgncGxheWVyLS1hY3RpdmUnKTtcbiAgfSBlbHNlIHtcbiAgICBwbGF5ZXJDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgncGxheWVyLS1hY3RpdmUnKTtcbiAgfVxufVxuXG5cbi8vINC30LLRg9C6XG5cbmNvbnN0IGNoYW5nZUNpcmNsZVBvc2l0aW9uID0gKHBlcmNlbnQpID0+IHtcbiAgLy8gcGxheWVyVmlkZW9DaXJjbGUuc3R5bGUubGVmdCA9IGAke3BlcmNlbnR9YDtcbn1cblxuXG5jb25zdCBjaGFuZ2VWb2x1bWUgPSAoZSkgPT4ge1xuXG4gIGNvbnN0IGN1cnJlbnRUYXJnZXQgPSBlLmN1cnJlbnRUYXJnZXQ7XG4gIGNvbnN0IGxlZnQgPSBlLm9mZnNldFg7XG5cbiAgY29uc3Qgc291bmRCYXJXaWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUoY3VycmVudFRhcmdldCkud2lkdGgpO1xuICBjb25zb2xlLmxvZyhsZWZ0KTtcbiAgY29uc29sZS5sb2coc291bmRCYXJXaWR0aCk7XG4gIGNvbnNvbGUubG9nKCdzb3VuZEJhcndpZHRoIC0gbGVmdCcsIHNvdW5kQmFyV2lkdGggLSBsZWZ0KTtcblxuXG4gIC8vIGNvbnN0IG5ld1Bvc2l0aW9uID0gZS5wYWdlWCAtIGxlZnQ7XG5cbiAgY29uc3QgcGVyY2VudFZhbHVlID0gKGxlZnQgLyBzb3VuZEJhcldpZHRoKSAqIDEwMDtcbiAgaWYgKHBlcmNlbnRWYWx1ZSA8IDEwMCkge1xuICAgIHZpZGVvLnZvbHVtZSA9IHBlcmNlbnRWYWx1ZSAvIDEwMDtcbiAgICBwbGF5ZXJWb2x1bWVDaXJjbGUuc3R5bGUubGVmdCA9IGAke3BlcmNlbnRWYWx1ZX0lYDtcbiAgICBjaGFuZ2VDaXJjbGVQb3NpdGlvbihwZXJjZW50VmFsdWUpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3ZvbHVtZS1iYXInKS5zdHlsZS53aWR0aCA9IGAke3BlcmNlbnRWYWx1ZX0lYDtcbiAgIFxuICB9XG5cbn1cblxuY29uc3QgdG9nZ2xlU291bmQgPSAoKSA9PiB7XG4gIHBsYXllclZvbHVtZUljb24uY2xhc3NMaXN0LnRvZ2dsZShcIm11dGVkXCIpO1xuICBpZiAodmlkZW8udm9sdW1lID09PSAwKSB7XG4gICAgdmlkZW8udm9sdW1lID0gY3VycmVudFZvbHVtZTtcbiAgICBwbGF5ZXJWb2x1bWVDaXJjbGUuc3R5bGUubGVmdCA9IGAke2N1cnJlbnRWb2x1bWUgKiAxMDB9JWA7XG4gICAgY2hhbmdlQ2lyY2xlUG9zaXRpb24oJ2N1cnJlbnRWb2x1bWUnICogMTAwKTtcbiAgfSBlbHNlIHtcbiAgICBjdXJyZW50Vm9sdW1lID0gdmlkZW8udm9sdW1lO1xuICAgIHZpZGVvLnZvbHVtZSA9IHN0YXJ0Vm9sdW1lO1xuICAgIHBsYXllclZvbHVtZUNpcmNsZS5zdHlsZS5sZWZ0ID0gYCR7c3RhcnRWb2x1bWV9JWA7XG4gICAgY2hhbmdlQ2lyY2xlUG9zaXRpb24oJ3N0YXJ0Vm9sdW1lJyk7XG4gIH1cbn1cblxuXG5wbGF5ZXJWb2x1bWVCYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjaGFuZ2VWb2x1bWUpO1xucGxheWVyVm9sdW1lSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVNvdW5kKTtcblxuLy8gRHVyYXRpb25cblxuY29uc3QgaGFuZGxlRHVyYXRpb24gPSAoZSkgPT4ge1xuXG4gIGNvbnN0IGJhclNpemUgPSBwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKHBsYXllclBsYXliYWNrKS53aWR0aCk7XG4gIGNvbnN0IGNpctGBbGVXaWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUocGxheWVyVmlkZW9DaXJjbGUpLndpZHRoKTtcblxuICAvLyBjb25zdCB7b2ZmU2V0WH0gPSBlO1xuXG4gIGNvbnN0IG9mZnNldFggPSBlLm9mZnNldFg7XG4gIGNvbnN0IHBlcmNlbnRWYWx1ZSA9IChvZmZzZXRYIC8gYmFyU2l6ZSkgKiAxMDA7XG4gIGNvbnN0IHZpZGVvRHVyYXRpb24gPSB2aWRlby5kdXJhdGlvbjtcbiAgY29uc3QgZHVyYXRpb25PbmUgPSB2aWRlby5kdXJhdGlvbiAvIDEwMDtcbiAgdmlkZW8uY3VycmVudFRpbWUgPSBwZXJjZW50VmFsdWUgKiBkdXJhdGlvbk9uZTtcbiAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHtwZXJjZW50VmFsdWV9JWA7XG59XG5cbmxldCBpbnRlcnZhbDtcbmNvbnN0IHVwZGF0ZVRpbWUgPSAoKSA9PiB7XG5cbiAgaWYgKHZpZGVvLnBhdXNlZCkge1xuICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICB9IGVsc2Uge1xuICAgIGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgY29uc3QgY29tcGxldGVkVGltZSA9IHZpZGVvLmN1cnJlbnRUaW1lO1xuICAgICAgY29uc3QgdmlkZW9EdXJhdGlvbiA9IHZpZGVvLmR1cmF0aW9uO1xuICAgICAgY29uc3QgY3VycmVudFRpbWUgPSAoY29tcGxldGVkVGltZSAvIHZpZGVvRHVyYXRpb24pICoxMDA7XG4gICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IGAke2N1cnJlbnRUaW1lfSVgO1xuICAgIH0sMTAwMCk7XG4gIFxuICB9XG4gICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHtjdXJyZW50VGltZX0lYDtcbn1cblxuXG5wbGF5ZXJQbGF5YmFjay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUR1cmF0aW9uKTtcbnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdXBkYXRlVGltZSk7IiwiY29uc3QgZmluZEJsb2NrQnlBbGlhcyA9IGFsaWFzID0+IHtcbiAgICByZXR1cm4gJChcIi5yZXZpZXdfX2l0ZW1cIikuZmlsdGVyKChuZHgsIGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuICQoaXRlbSkuYXR0cihcImRhdGEtbGlua2VkLXdpdGhcIikgPT0gYWxpYXNcbiAgICB9KTtcbn1cblxuJChcIi5hdmF0YXItcm91bmRcIikuY2xpY2soKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1vcGVuXCIpO1xuICAgIGNvbnN0IGN1ckl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLnVzZXJuYW1lc19faXRlbVwiKTtcbiAgICBjb25zdCBpdGVtVG9TaG93ID0gZmluZEJsb2NrQnlBbGlhcyh0YXJnZXQpO1xuXG4gICAgaXRlbVRvU2hvdy5hZGRDbGFzcyhcInJldmlld19faXRlbS0tYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJyZXZpZXdfX2l0ZW0tLWFjdGl2ZVwiKVxuICAgIGN1ckl0ZW0uYWRkQ2xhc3MoXCJ1c2VybmFtZS0tYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJ1c2VybmFtZS0tYWN0aXZlXCIpO1xufSkiLCJjb25zdCBzbGlkZXIgPSAkKCcuc2hvcF9fbGlzdCcpLmJ4U2xpZGVyKHtcbiAgICBwYWdlcjogZmFsc2UsXG4gICAgY29udHJvbHM6IGZhbHNlXG59KTtcblxuJCgnLnNob3BfX2J0bl9sZWZ0JykuY2xpY2soZSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgc2xpZGVyLmdvVG9QcmV2U2xpZGUoKTtcbn0pIFxuJCgnLnNob3BfX2J0bl9yaWdodCcpLmNsaWNrKGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIHNsaWRlci5nb1RvTmV4dFNsaWRlKCk7XG5cbn0pICIsImNvbnN0IHZhbGlkYXRlRmllbGRzID0gKGZvcm0sIGZpZWxkc0FycmF5KSA9PiB7XG5cbiAgICBmaWVsZHNBcnJheS5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgZmllbGQucmVtb3ZlQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcbiAgICAgICAgaWYoZmllbGQudmFsKCkudHJpbSgpID09IFwiXCIpIHtcbiAgICAgICAgICAgIGZpZWxkLmFkZENsYXNzKFwiaW5wdXQtZXJyb3JcIik7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IGVycm9yRmllbGRzID0gZm9ybS5maW5kKFwiLmlucHV0LWVycm9yXCIpO1xuXG4gICAgcmV0dXJuIGVycm9yRmllbGRzLmxlbmd0aCA9PSAwO1xuXG59XG5cbiQoJy5mb3JtJykuc3VibWl0KGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBcbiAgICBjb25zdCBmb3JtID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoXCJbbmFtZT0nbmFtZSddXCIpO1xuICAgIGNvbnN0IHBob25lID0gZm9ybS5maW5kKFwiW25hbWU9J3Bob25lJ11cIik7XG4gICAgY29uc3QgY29tbWVudCA9IGZvcm0uZmluZChcIltuYW1lPSdjb21tZW50J11cIik7XG4gICAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKTtcblxuICAgIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcbiAgICBjb25zdCBjb250ZW50ID0gbW9kYWwuZmluZChcIi5tb2RhbF9fY29udGVudFwiKTtcblxuICAgIG1vZGFsLnJlbW92ZUNsYXNzKFwiZXJyb3ItbW9kYWxcIik7XG5cbiAgICBjb25zdCBpc1ZhbGlkID0gdmFsaWRhdGVGaWVsZHMoZm9ybSwgW25hbWUsIHBob25lLCBjb21tZW50LCB0b10pO1xuXG4gICAgaWYgKGlzVmFsaWQpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9ICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6XCJodHRwczovL3dlYmRldi1hcGkubG9mdHNjaG9vbC5jb20vc2VuZG1haWxcIixcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgbmFtZTpuYW1lLnZhbCgpLFxuICAgICAgICAgICAgICAgIHBob25lOiBwaG9uZS52YWwoKSxcbiAgICAgICAgICAgICAgICBjb21tZW50OmNvbW1lbnQudmFsKCksXG4gICAgICAgICAgICAgICAgdG86dG8udmFsKCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJlcXVlc3QuZG9uZShkYXRhID0+IHtcbiAgICAgICAgICAgIGNvbnRlbnQudGV4dChkYXRhLm1lc3NhZ2UpXG4gICAgICAgICAgICBcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmVxdWVzdC5mYWlsKGRhdGEgPT4ge1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEucmVzcG9uc2VKU09OLm1lc3NhZ2U7XG4gICAgICAgICAgICBjb250ZW50LnRleHQobWVzc2FnZSk7XG4gICAgICAgICAgICBtb2RhbC5hZGRDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcbiAgICAgICAgICAgICQuZmFuY3lib3gub3Blbih7XG4gICAgICAgICAgICAgICAgc3JjOiBcIiNtb2RhbFwiLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwiaW5saW5lXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgIH1cbiAgICBcbn0pO1xuXG4kKFwiLmFwcC1zdWJtaXQtYnRuXCIpLmNsaWNrKGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICQuZmFuY3lib3guY2xvc2UoKTtcbn0pIl19
